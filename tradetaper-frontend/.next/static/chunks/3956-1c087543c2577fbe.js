"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3956],{23352:(e,a,t)=>{t.d(a,{$L:()=>c,Ay:()=>D,Cm:()=>l,Gz:()=>u,IJ:()=>I,P:()=>P,PE:()=>i,YY:()=>f,cV:()=>C,dq:()=>F,kQ:()=>h,s5:()=>p,tJ:()=>L});var r=t(51990),s=t(80722);let d={trades:[],isLoading:!1,error:null,currentTrade:null,filters:{},analyticsFilters:{analyticsDateFrom:"",analyticsDateTo:""},total:0,page:1,limit:10};function o(e){return{id:e.id,userId:e.userId,assetType:e.assetType,symbol:e.symbol,direction:e.side,status:e.status,entryDate:e.openTime,entryPrice:parseFloat(e.openPrice),exitDate:e.closeTime,exitPrice:e.closePrice?parseFloat(e.closePrice):void 0,quantity:parseFloat(e.quantity),stopLoss:e.stopLoss?parseFloat(e.stopLoss):void 0,takeProfit:e.takeProfit?parseFloat(e.takeProfit):void 0,commission:e.commission?parseFloat(e.commission):void 0,notes:e.notes,profitOrLoss:e.profitOrLoss?parseFloat(e.profitOrLoss):void 0,rMultiple:e.rMultiple?parseFloat(e.rMultiple):void 0,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tags:e.tags||[],createdAt:e.createdAt,updatedAt:e.updatedAt,accountId:e.accountId,isStarred:e.isStarred||!1}}function n(e){let a=e=>{if(e)try{if(e.includes("T")&&(e.includes("Z")||e.includes("+")||e.includes("-")))return e;return new Date(e).toISOString()}catch(a){console.error("Error formatting date for API:",e,a);return}};return{assetType:e.assetType,symbol:e.symbol,side:e.direction,status:e.status,openTime:a(e.entryDate),openPrice:e.entryPrice,closeTime:a(e.exitDate),closePrice:e.exitPrice,quantity:e.quantity,stopLoss:e.stopLoss,takeProfit:e.takeProfit,commission:e.commission,notes:e.notes,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tagNames:e.tagNames,accountId:e.accountId,isStarred:e.isStarred}}let l=(0,r.zD)("trades/fetchTrades",async(e,a)=>{let{accountId:t,page:r=1,limit:d=10}=e,{rejectWithValue:n}=a;try{let e="/trades?page=".concat(r,"&limit=").concat(d);t&&(e+="&accountId=".concat(t));let a=await s.Y0.get(e);console.log("Raw fetchTrades from API (accountId: ".concat(t||"all","):"),a.data);let n=a.data.data.map(o);return console.log("Transformed trades for frontend:",n),{data:n,total:a.data.total,page:a.data.page,limit:a.data.limit}}catch(e){var l,i;return n((null==(i=e.response)||null==(l=i.data)?void 0:l.message)||e.message||"Failed to fetch trades")}}),i=(0,r.zD)("trades/fetchTradeById",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await s.Y0.get("/trades/".concat(e));console.log("Raw fetchTradeById from API:",a.data);let t=o(a.data);return console.log("Transformed trade for frontend:",t),t}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to fetch trade")}}),c=(0,r.zD)("trades/createTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=n(e);console.log("Frontend payload:",e),console.log("Transformed API payload:",a);let t=await s.Y0.post("/trades",a);console.log("Raw createTrade from API:",t.data);let r=o(t.data);return console.log("Transformed created trade for frontend:",r),r}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to create trade")}}),u=(0,r.zD)("trades/updateTrade",async(e,a)=>{let{id:t,payload:r}=e,{rejectWithValue:d}=a;try{let e=n(r);console.log("Frontend updateTrade payload:",r),console.log("Transformed updateTrade API payload:",e);let a=await s.Y0.patch("/trades/".concat(t),e);console.log("Raw updateTrade from API:",a.data);let d=o(a.data);return console.log("Transformed updated trade for frontend:",d),d}catch(e){var l,i;return d((null==(i=e.response)||null==(l=i.data)?void 0:l.message)||e.message||"Failed to update trade")}}),p=(0,r.zD)("trades/deleteTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{return await s.Y0.delete("/trades/".concat(e)),e}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to delete trade")}}),y=(0,r.zD)("trades/analyzeChart",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=new FormData;return a.append("file",e),(await s.Y0.post("/trades/analyze-chart",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to analyze chart")}}),g=(0,r.Z0)({name:"trades",initialState:d,reducers:{clearTradesError(e){e.error=null},setCurrentTrade(e,a){e.currentTrade=a.payload},setTradeFilters(e,a){e.filters={...e.filters,...a.payload}},resetTradeFilters(e){e.filters=d.filters},setAnalyticsDateFilters(e,a){e.analyticsFilters={...e.analyticsFilters,...a.payload}},resetAnalyticsDateFilters(e){e.analyticsFilters=d.analyticsFilters},addTrade(e,a){-1===e.trades.findIndex(e=>e.id===a.payload.id)&&e.trades.unshift(a.payload)},updateTradeRealtime(e,a){var t;let r=e.trades.findIndex(e=>e.id===a.payload.id);-1!==r&&(e.trades[r]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)},removeTrade(e,a){var t;e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)},setTrades(e,a){e.trades=a.payload}},extraReducers:e=>{e.addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.isLoading=!1,e.trades=a.payload.data,e.total=a.payload.total,e.page=a.payload.page,e.limit=a.payload.limit}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1,e.currentTrade=a.payload}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(c.pending,e=>{e.isLoading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.isLoading=!1,e.trades.unshift(a.payload)}).addCase(c.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(u.pending,e=>{e.isLoading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{var t;e.isLoading=!1;let r=e.trades.findIndex(e=>e.id===a.payload.id);-1!==r&&(e.trades[r]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)}).addCase(u.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(p.pending,e=>{e.isLoading=!0,e.error=null}).addCase(p.fulfilled,(e,a)=>{var t;e.isLoading=!1,e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)}).addCase(p.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(y.pending,e=>{e.isLoading=!0,e.error=null}).addCase(y.fulfilled,(e,a)=>{e.isLoading=!1,console.log("Chart analysis successful:",a.payload)}).addCase(y.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{clearTradesError:m,setCurrentTrade:f,setTradeFilters:T,resetTradeFilters:v,setAnalyticsDateFilters:C,resetAnalyticsDateFilters:L,addTrade:h,updateTradeRealtime:P,removeTrade:F,setTrades:I}=g.actions,D=g.reducer},56051:(e,a,t)=>{t.d(a,{PW:()=>r,d1:()=>d,w_:()=>s});var r=function(e){return e.STOCK="Stock",e.CRYPTO="Crypto",e.FOREX="Forex",e.COMMODITIES="Commodities",e.FUTURES="Futures",e.OPTIONS="Options",e}({}),s=function(e){return e.LONG="Long",e.SHORT="Short",e}({}),d=function(e){return e.OPEN="Open",e.CLOSED="Closed",e.PENDING="Pending",e.CANCELLED="Cancelled",e}({})},71079:(e,a,t)=>{t.d(a,{e:()=>d});var r=t(95155);t(12115);var s=t(95557);let d=e=>{let{amount:a,fromCurrency:t="USD",className:d="",showOriginal:o=!1,precision:n}=e,{formatCurrency:l,selectedCurrency:i,convertAmount:c}=(0,s.H2)();if(0===a)return(0,r.jsx)("span",{className:d,children:"0"});if(isNaN(a))return(0,r.jsx)("span",{className:d,children:"-"});let u=l(a,t);c(a,t);let p=o&&t!==i;return(0,r.jsxs)("span",{className:d,title:p?"Original: ".concat(a.toFixed(n||2)," ").concat(t):void 0,children:[u,p&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-1",children:["(",a.toFixed(n||2)," ",t,")"]})]})}},80722:(e,a,t)=>{t.d(a,{Y0:()=>o,uE:()=>d,wv:()=>n});var r=t(23464);let s="https://tradetaper-backend-481634875325.us-central1.run.app/api/v1";console.log("\uD83D\uDD27 API Configuration:",{env:"production",apiUrl:s,envVar:"https://tradetaper-backend-481634875325.us-central1.run.app/api/v1",timestamp:new Date().toISOString()});let d=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"}}),o=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"}});function n(e){o.interceptors.request.use(a=>{let t=e().auth.token;return t&&(a.headers.Authorization="Bearer ".concat(t)),console.log("\uD83D\uDE80 Making authenticated API request to:",a.baseURL+a.url),a},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{var a,t,r;return console.error("‚ùå API Request failed:",{url:null==(a=e.config)?void 0:a.url,baseURL:null==(t=e.config)?void 0:t.baseURL,status:null==(r=e.response)?void 0:r.status,message:e.message}),e.response&&401===e.response.status&&console.log("Unauthorized from interceptor..."),Promise.reject(e)}),console.log("[API.TS] Auth interceptors configured.")}}}]);