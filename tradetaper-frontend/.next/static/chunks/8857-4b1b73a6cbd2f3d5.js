"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8857],{23352:(e,a,t)=>{t.d(a,{$L:()=>i,Ay:()=>F,Cm:()=>n,Gz:()=>u,IJ:()=>v,P:()=>L,PE:()=>l,YY:()=>m,cV:()=>D,dq:()=>I,kQ:()=>T,s5:()=>p,tJ:()=>C});var o=t(51990),r=t(80722);let c={trades:[],isLoading:!1,error:null,currentTrade:null,filters:{},analyticsFilters:{analyticsDateFrom:"",analyticsDateTo:""}};function s(e){return{id:e.id,userId:e.userId,assetType:e.assetType,symbol:e.symbol,direction:e.side,status:e.status,entryDate:e.openTime,entryPrice:parseFloat(e.openPrice),exitDate:e.closeTime,exitPrice:e.closePrice?parseFloat(e.closePrice):void 0,quantity:parseFloat(e.quantity),stopLoss:e.stopLoss?parseFloat(e.stopLoss):void 0,takeProfit:e.takeProfit?parseFloat(e.takeProfit):void 0,commission:e.commission?parseFloat(e.commission):void 0,notes:e.notes,profitOrLoss:e.profitOrLoss?parseFloat(e.profitOrLoss):void 0,rMultiple:e.rMultiple?parseFloat(e.rMultiple):void 0,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tags:e.tags||[],createdAt:e.createdAt,updatedAt:e.updatedAt,accountId:e.accountId,isStarred:e.isStarred||!1}}function d(e){let a=e=>{if(e)try{if(e.includes("T")&&(e.includes("Z")||e.includes("+")||e.includes("-")))return e;return new Date(e).toISOString()}catch(a){console.error("Error formatting date for API:",e,a);return}};return{assetType:e.assetType,symbol:e.symbol,side:e.direction,status:e.status,openTime:a(e.entryDate),openPrice:e.entryPrice,closeTime:a(e.exitDate),closePrice:e.exitPrice,quantity:e.quantity,stopLoss:e.stopLoss,takeProfit:e.takeProfit,commission:e.commission,notes:e.notes,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tagNames:e.tagNames,accountId:e.accountId,isStarred:e.isStarred}}let n=(0,o.zD)("trades/fetchTrades",async(e,a)=>{let{rejectWithValue:t}=a;try{let a="/trades";e&&(a+="?accountId=".concat(e));let t=await r.Y0.get(a);console.log("Raw fetchTrades from API (accountId: ".concat(e||"all","):"),t.data);let o=t.data.map(s);return console.log("Transformed trades for frontend:",o),o}catch(e){var o,c;return t((null==(c=e.response)||null==(o=c.data)?void 0:o.message)||e.message||"Failed to fetch trades")}}),l=(0,o.zD)("trades/fetchTradeById",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await r.Y0.get("/trades/".concat(e));console.log("Raw fetchTradeById from API:",a.data);let t=s(a.data);return console.log("Transformed trade for frontend:",t),t}catch(e){var o,c;return t((null==(c=e.response)||null==(o=c.data)?void 0:o.message)||e.message||"Failed to fetch trade")}}),i=(0,o.zD)("trades/createTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=d(e);console.log("Frontend payload:",e),console.log("Transformed API payload:",a);let t=await r.Y0.post("/trades",a);console.log("Raw createTrade from API:",t.data);let o=s(t.data);return console.log("Transformed created trade for frontend:",o),o}catch(e){var o,c;return t((null==(c=e.response)||null==(o=c.data)?void 0:o.message)||e.message||"Failed to create trade")}}),u=(0,o.zD)("trades/updateTrade",async(e,a)=>{let{id:t,payload:o}=e,{rejectWithValue:c}=a;try{let e=d(o);console.log("Frontend updateTrade payload:",o),console.log("Transformed updateTrade API payload:",e);let a=await r.Y0.patch("/trades/".concat(t),e);console.log("Raw updateTrade from API:",a.data);let c=s(a.data);return console.log("Transformed updated trade for frontend:",c),c}catch(e){var n,l;return c((null==(l=e.response)||null==(n=l.data)?void 0:n.message)||e.message||"Failed to update trade")}}),p=(0,o.zD)("trades/deleteTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{return await r.Y0.delete("/trades/".concat(e)),e}catch(e){var o,c;return t((null==(c=e.response)||null==(o=c.data)?void 0:o.message)||e.message||"Failed to delete trade")}}),y=(0,o.Z0)({name:"trades",initialState:c,reducers:{clearTradesError(e){e.error=null},setCurrentTrade(e,a){e.currentTrade=a.payload},setTradeFilters(e,a){e.filters={...e.filters,...a.payload}},resetTradeFilters(e){e.filters=c.filters},setAnalyticsDateFilters(e,a){e.analyticsFilters={...e.analyticsFilters,...a.payload}},resetAnalyticsDateFilters(e){e.analyticsFilters=c.analyticsFilters},addTrade(e,a){-1===e.trades.findIndex(e=>e.id===a.payload.id)&&e.trades.unshift(a.payload)},updateTradeRealtime(e,a){var t;let o=e.trades.findIndex(e=>e.id===a.payload.id);-1!==o&&(e.trades[o]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)},removeTrade(e,a){var t;e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)},setTrades(e,a){e.trades=a.payload}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1,e.trades=a.payload}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.isLoading=!1,e.currentTrade=a.payload}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1,e.trades.unshift(a.payload)}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(u.pending,e=>{e.isLoading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{var t;e.isLoading=!1;let o=e.trades.findIndex(e=>e.id===a.payload.id);-1!==o&&(e.trades[o]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)}).addCase(u.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(p.pending,e=>{e.isLoading=!0,e.error=null}).addCase(p.fulfilled,(e,a)=>{var t;e.isLoading=!1,e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)}).addCase(p.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{clearTradesError:g,setCurrentTrade:m,setTradeFilters:A,resetTradeFilters:f,setAnalyticsDateFilters:D,resetAnalyticsDateFilters:C,addTrade:T,updateTradeRealtime:L,removeTrade:I,setTrades:v}=y.actions,F=y.reducer},70392:(e,a,t)=>{t.d(a,{_m:()=>d,Ay:()=>v,BF:()=>l,Tq:()=>s,tW:()=>I,jA:()=>L,G6:()=>D,xB:()=>T,i7:()=>C,Rc:()=>p,RS:()=>n});var o=t(51990),r=t(80722);let c={getAccounts:async()=>(await r.Y0.get("/accounts")).data,getAccount:async e=>(await r.Y0.get("/accounts/".concat(e))).data,createAccount:async e=>(await r.Y0.post("/accounts",e)).data,updateAccount:async(e,a)=>(await r.Y0.put("/accounts/".concat(e),a)).data,async deleteAccount(e){await r.Y0.delete("/accounts/".concat(e))}},s=(0,o.zD)("accounts/fetchAccounts",async()=>await c.getAccounts()),d=(0,o.zD)("accounts/createAccount",async e=>await c.createAccount(e)),n=(0,o.zD)("accounts/updateAccount",async e=>{let{id:a,...t}=e;return await c.updateAccount(a,t)}),l=(0,o.zD)("accounts/deleteAccount",async e=>(await c.deleteAccount(e),e)),i=(0,o.Z0)({name:"accounts",initialState:{accounts:[],selectedAccountId:null,isLoading:!1,error:null},reducers:{setAccounts:(e,a)=>{e.accounts=a.payload,e.selectedAccountId&&!e.accounts.find(a=>a.id===e.selectedAccountId)&&(e.selectedAccountId=null)},setSelectedAccount:(e,a)=>{null===a.payload?e.selectedAccountId=null:e.accounts.find(e=>e.id===a.payload)?e.selectedAccountId=a.payload:console.warn("Attempted to select non-existent account ID: ".concat(a.payload))},addAccount:(e,a)=>{e.accounts.push(a.payload),e.selectedAccountId||(e.selectedAccountId=a.payload.id)},updateAccount:(e,a)=>{let t=e.accounts.findIndex(e=>e.id===a.payload.id);-1!==t?e.accounts[t]={...e.accounts[t],...a.payload}:console.warn("Attempted to update non-existent account ID: ".concat(a.payload.id))},deleteAccount:(e,a)=>{let t=a.payload;e.accounts=e.accounts.filter(e=>e.id!==t),e.selectedAccountId===t&&(e.selectedAccountId=null)},setLoading:(e,a)=>{e.isLoading=a.payload},setError:(e,a)=>{e.error=a.payload}},extraReducers:e=>{e.addCase(s.pending,e=>{e.isLoading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts=a.payload,e.selectedAccountId&&!a.payload.find(a=>a.id===e.selectedAccountId)&&(e.selectedAccountId=null)}).addCase(s.rejected,(e,a)=>{e.isLoading=!1,e.error=a.error.message||"Failed to fetch accounts"}).addCase(d.pending,e=>{e.isLoading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts.push(a.payload),e.selectedAccountId||(e.selectedAccountId=a.payload.id)}).addCase(d.rejected,(e,a)=>{e.isLoading=!1,e.error=a.error.message||"Failed to create account"}).addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1;let t=e.accounts.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.accounts[t]=a.payload)}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.error.message||"Failed to update account"}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts=e.accounts.filter(e=>e.id!==a.payload),e.selectedAccountId===a.payload&&(e.selectedAccountId=null)}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.error.message||"Failed to delete account"})}}),{setAccounts:u,setSelectedAccount:p,addAccount:y,updateAccount:g,deleteAccount:m,setLoading:A,setError:f}=i.actions,D=e=>e.accounts.accounts,C=e=>e.accounts.selectedAccountId,T=e=>{let a=e.accounts.selectedAccountId;return e.accounts.accounts.find(e=>e.id===a)||null},L=e=>e.accounts.isLoading,I=e=>e.accounts.error,v=i.reducer},74229:(e,a,t)=>{t.d(a,{y:()=>c});var o=t(80722);let r="/mt5-accounts",c={getAccounts:async()=>(await o.Y0.get(r)).data,getAccount:async e=>(await o.Y0.get("".concat(r,"/").concat(e))).data,async getServers(){try{return(await o.Y0.get("".concat(r,"/servers"))).data}catch(e){return console.error("Failed to fetch MT5 servers:",e),[{name:"demo.mt5.com",description:"MetaTrader 5 Demo Server"},{name:"icmarkets-demo",description:"IC Markets Demo Server"},{name:"fxpro-mt5demo",description:"FxPro Demo Server"},{name:"pepperstone-demo",description:"Pepperstone Demo Server"},{name:"xm-demo",description:"XM Demo Server"}]}},createAccount:async e=>(await o.Y0.post(r,e)).data,updateAccount:async(e,a)=>(await o.Y0.patch("".concat(r,"/").concat(e),a)).data,async deleteAccount(e){await o.Y0.delete("".concat(r,"/").concat(e))},syncAccount:async e=>(await o.Y0.post("".concat(r,"/").concat(e,"/sync"))).data,importTrades:async(e,a,t)=>(await o.Y0.post("".concat(r,"/").concat(e,"/import-trades"),{fromDate:a.toISOString(),toDate:t.toISOString()})).data,validateConnection:async e=>(await o.Y0.post("".concat(r,"/").concat(e,"/validate"))).data}},80722:(e,a,t)=>{t.d(a,{Y0:()=>s,uE:()=>c,wv:()=>d});var o=t(23464);let r="https://tradetaper-backend-481634875325.us-central1.run.app/api/v1";console.log("\uD83D\uDD27 API Configuration:",{env:"production",apiUrl:r,envVar:"https://tradetaper-backend-481634875325.us-central1.run.app/api/v1",timestamp:new Date().toISOString()});let c=o.A.create({baseURL:r,headers:{"Content-Type":"application/json"}}),s=o.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});function d(e){s.interceptors.request.use(a=>{let t=e().auth.token;return t&&(a.headers.Authorization="Bearer ".concat(t)),console.log("\uD83D\uDE80 Making authenticated API request to:",a.baseURL+a.url),a},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var a,t,o;return console.error("❌ API Request failed:",{url:null==(a=e.config)?void 0:a.url,baseURL:null==(t=e.config)?void 0:t.baseURL,status:null==(o=e.response)?void 0:o.status,message:e.message}),e.response&&401===e.response.status&&console.log("Unauthorized from interceptor..."),Promise.reject(e)}),console.log("[API.TS] Auth interceptors configured.")}},95557:(e,a,t)=>{t.d(a,{BD:()=>n,H2:()=>l,yR:()=>c});var o=t(95155),r=t(12115);let c={USD:{symbol:"$",name:"US Dollar",flag:"\uD83C\uDDFA\uD83C\uDDF8"},EUR:{symbol:"€",name:"Euro",flag:"\uD83C\uDDEA\uD83C\uDDFA"},GBP:{symbol:"\xa3",name:"British Pound",flag:"\uD83C\uDDEC\uD83C\uDDE7"},JPY:{symbol:"\xa5",name:"Japanese Yen",flag:"\uD83C\uDDEF\uD83C\uDDF5"},CHF:{symbol:"CHF",name:"Swiss Franc",flag:"\uD83C\uDDE8\uD83C\uDDED"},CAD:{symbol:"C$",name:"Canadian Dollar",flag:"\uD83C\uDDE8\uD83C\uDDE6"},AUD:{symbol:"A$",name:"Australian Dollar",flag:"\uD83C\uDDE6\uD83C\uDDFA"},NZD:{symbol:"NZ$",name:"New Zealand Dollar",flag:"\uD83C\uDDF3\uD83C\uDDFF"}},s=(0,r.createContext)(void 0),d=async e=>{let a={USD:{EUR:.85,GBP:.73,JPY:110,CHF:.92,CAD:1.25,AUD:1.35,NZD:1.45,USD:1},EUR:{USD:1.18,GBP:.86,JPY:129.5,CHF:1.08,CAD:1.47,AUD:1.59,NZD:1.71,EUR:1},GBP:{USD:1.37,EUR:1.16,JPY:150.7,CHF:1.26,CAD:1.71,AUD:1.85,NZD:1.99,GBP:1},JPY:{USD:.0091,EUR:.0077,GBP:.0066,CHF:.0084,CAD:.0114,AUD:.0123,NZD:.0132,JPY:1},CHF:{USD:1.09,EUR:.93,GBP:.79,JPY:119.6,CAD:1.36,AUD:1.47,NZD:1.58,CHF:1},CAD:{USD:.8,EUR:.68,GBP:.58,JPY:88,CHF:.74,AUD:1.08,NZD:1.16,CAD:1},AUD:{USD:.74,EUR:.63,GBP:.54,JPY:81.5,CHF:.68,CAD:.93,NZD:1.07,AUD:1},NZD:{USD:.69,EUR:.58,GBP:.5,JPY:75.9,CHF:.63,CAD:.86,AUD:.93,NZD:1}};return await new Promise(e=>setTimeout(e,500)),a[e]||a.USD},n=e=>{let{children:a}=e,[t,n]=(0,r.useState)("USD"),[l,i]=(0,r.useState)({}),[u,p]=(0,r.useState)(!1),[y,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("tradeTaper.selectedCurrency");e&&e in c&&n(e)},[]),(0,r.useEffect)(()=>{(async()=>{p(!0);try{let e=await d(t);i(e),g(new Date)}catch(e){console.error("Failed to fetch exchange rates:",e),i({[t]:1})}finally{p(!1)}})()},[t]);let m=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";if(a===t)return e;let o=l[a];return o?e*o:e};return(0,o.jsx)(s.Provider,{value:{selectedCurrency:t,setSelectedCurrency:e=>{n(e),localStorage.setItem("tradeTaper.selectedCurrency",e)},exchangeRates:l,convertAmount:m,formatCurrency:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",o=m(e,a),r=c[t],s=2*("JPY"!==t);return"".concat(r.symbol).concat(o.toLocaleString(void 0,{minimumFractionDigits:s,maximumFractionDigits:s}))},isLoading:u,lastUpdated:y},children:a})},l=()=>{let e=(0,r.useContext)(s);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},96787:(e,a,t)=>{t.d(a,{Ay:()=>C,FW:()=>s,S1:()=>d,T$:()=>i,Tq:()=>A,Xg:()=>n,bw:()=>g,ho:()=>f,kI:()=>m,nS:()=>D,t_:()=>l,vh:()=>p});var o=t(51990),r=t(74229),c=t(13568);let s=(0,o.zD)("mt5Accounts/fetchAccounts",async(e,a)=>{let{rejectWithValue:t}=a;try{return await r.y.getAccounts()}catch(e){return t(e.message||"Failed to fetch MT5 accounts")}}),d=(0,o.zD)("mt5Accounts/createAccount",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await r.y.createAccount(e);return c.Ay.success("MT5 account created successfully"),a}catch(e){return c.Ay.error(e.message||"Failed to create MT5 account"),t(e.message||"Failed to create MT5 account")}}),n=(0,o.zD)("mt5Accounts/updateAccount",async(e,a)=>{let{id:t,data:o}=e,{rejectWithValue:s}=a;try{let e=await r.y.updateAccount(t,o);return c.Ay.success("MT5 account updated successfully"),e}catch(e){return c.Ay.error(e.message||"Failed to update MT5 account"),s(e.message||"Failed to update MT5 account")}}),l=(0,o.zD)("mt5Accounts/deleteAccount",async(e,a)=>{let{rejectWithValue:t}=a;try{return await r.y.deleteAccount(e),c.Ay.success("MT5 account deleted successfully"),e}catch(e){return c.Ay.error(e.message||"Failed to delete MT5 account"),t(e.message||"Failed to delete MT5 account")}}),i=(0,o.zD)("mt5Accounts/syncAccount",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await r.y.syncAccount(e);return c.Ay.success("MT5 account synced successfully"),a}catch(e){return c.Ay.error(e.message||"Failed to sync MT5 account"),t(e.message||"Failed to sync MT5 account")}}),u=(0,o.Z0)({name:"mt5Accounts",initialState:{accounts:[],selectedAccountId:null,isLoading:!1,error:null},reducers:{setSelectedMT5Account:(e,a)=>{e.selectedAccountId=a.payload},clearMT5Accounts:e=>{e.accounts=[],e.selectedAccountId=null}},extraReducers:e=>{e.addCase(s.pending,e=>{e.isLoading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts=a.payload,e.error=null}).addCase(s.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(d.pending,e=>{e.isLoading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts.push(a.payload),e.selectedAccountId=a.payload.id,e.error=null}).addCase(d.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1;let t=e.accounts.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.accounts[t]=a.payload),e.error=null}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.isLoading=!1,e.accounts=e.accounts.filter(e=>e.id!==a.payload),e.selectedAccountId===a.payload&&(e.selectedAccountId=null),e.error=null}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1;let t=e.accounts.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.accounts[t]=a.payload),e.error=null}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{setSelectedMT5Account:p,clearMT5Accounts:y}=u.actions,g=e=>e.mt5Accounts.accounts,m=e=>e.mt5Accounts.selectedAccountId,A=e=>{let a=e.mt5Accounts.selectedAccountId;return a?e.mt5Accounts.accounts.find(e=>e.id===a):null},f=e=>e.mt5Accounts.isLoading,D=e=>e.mt5Accounts.error,C=u.reducer}}]);