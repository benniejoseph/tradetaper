"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8272],{23352:(e,a,t)=>{t.d(a,{$L:()=>c,Ay:()=>k,Cm:()=>n,Gz:()=>u,IJ:()=>F,P:()=>P,PE:()=>i,YY:()=>f,cV:()=>v,dq:()=>I,kQ:()=>C,s5:()=>p,tJ:()=>L});var r=t(51990),s=t(80722);let d={trades:[],isLoading:!1,error:null,currentTrade:null,filters:{},analyticsFilters:{analyticsDateFrom:"",analyticsDateTo:""},total:0,page:1,limit:10};function o(e){return{id:e.id,userId:e.userId,assetType:e.assetType,symbol:e.symbol,direction:e.side,status:e.status,entryDate:e.openTime,entryPrice:parseFloat(e.openPrice),exitDate:e.closeTime,exitPrice:e.closePrice?parseFloat(e.closePrice):void 0,quantity:parseFloat(e.quantity),stopLoss:e.stopLoss?parseFloat(e.stopLoss):void 0,takeProfit:e.takeProfit?parseFloat(e.takeProfit):void 0,commission:e.commission?parseFloat(e.commission):void 0,notes:e.notes,profitOrLoss:e.profitOrLoss?parseFloat(e.profitOrLoss):void 0,rMultiple:e.rMultiple?parseFloat(e.rMultiple):void 0,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tags:e.tags||[],createdAt:e.createdAt,updatedAt:e.updatedAt,accountId:e.accountId,isStarred:e.isStarred||!1}}function l(e){let a=e=>{if(e)try{if(e.includes("T")&&(e.includes("Z")||e.includes("+")||e.includes("-")))return e;return new Date(e).toISOString()}catch(a){console.error("Error formatting date for API:",e,a);return}};return{assetType:e.assetType,symbol:e.symbol,side:e.direction,status:e.status,openTime:a(e.entryDate),openPrice:e.entryPrice,closeTime:a(e.exitDate),closePrice:e.exitPrice,quantity:e.quantity,stopLoss:e.stopLoss,takeProfit:e.takeProfit,commission:e.commission,notes:e.notes,ictConcept:e.ictConcept,session:e.session,setupDetails:e.setupDetails,mistakesMade:e.mistakesMade,lessonsLearned:e.lessonsLearned,imageUrl:e.imageUrl,tagNames:e.tagNames,accountId:e.accountId,isStarred:e.isStarred}}let n=(0,r.zD)("trades/fetchTrades",async(e,a)=>{let{accountId:t,page:r=1,limit:d=10}=e,{rejectWithValue:l}=a;try{let e="/trades?page=".concat(r,"&limit=").concat(d);t&&(e+="&accountId=".concat(t));let a=await s.Y0.get(e);console.log("Raw fetchTrades from API (accountId: ".concat(t||"all","):"),a.data);let l=a.data.data.map(o);return console.log("Transformed trades for frontend:",l),{data:l,total:a.data.total,page:a.data.page,limit:a.data.limit}}catch(e){var n,i;return l((null==(i=e.response)||null==(n=i.data)?void 0:n.message)||e.message||"Failed to fetch trades")}}),i=(0,r.zD)("trades/fetchTradeById",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await s.Y0.get("/trades/".concat(e));console.log("Raw fetchTradeById from API:",a.data);let t=o(a.data);return console.log("Transformed trade for frontend:",t),t}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to fetch trade")}}),c=(0,r.zD)("trades/createTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=l(e);console.log("Frontend payload:",e),console.log("Transformed API payload:",a);let t=await s.Y0.post("/trades",a);console.log("Raw createTrade from API:",t.data);let r=o(t.data);return console.log("Transformed created trade for frontend:",r),r}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to create trade")}}),u=(0,r.zD)("trades/updateTrade",async(e,a)=>{let{id:t,payload:r}=e,{rejectWithValue:d}=a;try{let e=l(r);console.log("Frontend updateTrade payload:",r),console.log("Transformed updateTrade API payload:",e);let a=await s.Y0.patch("/trades/".concat(t),e);console.log("Raw updateTrade from API:",a.data);let d=o(a.data);return console.log("Transformed updated trade for frontend:",d),d}catch(e){var n,i;return d((null==(i=e.response)||null==(n=i.data)?void 0:n.message)||e.message||"Failed to update trade")}}),p=(0,r.zD)("trades/deleteTrade",async(e,a)=>{let{rejectWithValue:t}=a;try{return await s.Y0.delete("/trades/".concat(e)),e}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to delete trade")}}),m=(0,r.zD)("trades/analyzeChart",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=new FormData;return a.append("file",e),(await s.Y0.post("/trades/analyze-chart",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){var r,d;return t((null==(d=e.response)||null==(r=d.data)?void 0:r.message)||e.message||"Failed to analyze chart")}}),g=(0,r.Z0)({name:"trades",initialState:d,reducers:{clearTradesError(e){e.error=null},setCurrentTrade(e,a){e.currentTrade=a.payload},setTradeFilters(e,a){e.filters={...e.filters,...a.payload}},resetTradeFilters(e){e.filters=d.filters},setAnalyticsDateFilters(e,a){e.analyticsFilters={...e.analyticsFilters,...a.payload}},resetAnalyticsDateFilters(e){e.analyticsFilters=d.analyticsFilters},addTrade(e,a){-1===e.trades.findIndex(e=>e.id===a.payload.id)&&e.trades.unshift(a.payload)},updateTradeRealtime(e,a){var t;let r=e.trades.findIndex(e=>e.id===a.payload.id);-1!==r&&(e.trades[r]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)},removeTrade(e,a){var t;e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)},setTrades(e,a){e.trades=a.payload}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1,e.trades=a.payload.data,e.total=a.payload.total,e.page=a.payload.page,e.limit=a.payload.limit}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1,e.currentTrade=a.payload}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(c.pending,e=>{e.isLoading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.isLoading=!1,e.trades.unshift(a.payload)}).addCase(c.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(u.pending,e=>{e.isLoading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{var t;e.isLoading=!1;let r=e.trades.findIndex(e=>e.id===a.payload.id);-1!==r&&(e.trades[r]=a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload.id&&(e.currentTrade=a.payload)}).addCase(u.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(p.pending,e=>{e.isLoading=!0,e.error=null}).addCase(p.fulfilled,(e,a)=>{var t;e.isLoading=!1,e.trades=e.trades.filter(e=>e.id!==a.payload),(null==(t=e.currentTrade)?void 0:t.id)===a.payload&&(e.currentTrade=null)}).addCase(p.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(m.pending,e=>{e.isLoading=!0,e.error=null}).addCase(m.fulfilled,(e,a)=>{e.isLoading=!1,console.log("Chart analysis successful:",a.payload)}).addCase(m.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{clearTradesError:y,setCurrentTrade:f,setTradeFilters:T,resetTradeFilters:h,setAnalyticsDateFilters:v,resetAnalyticsDateFilters:L,addTrade:C,updateTradeRealtime:P,removeTrade:I,setTrades:F}=g.actions,k=g.reducer},37049:(e,a,t)=>{t.d(a,{D:()=>l,ThemeProvider:()=>o});var r=t(95155),s=t(12115);let d=(0,s.createContext)(void 0),o=e=>{let{children:a}=e,[t,o]=(0,s.useState)("dark");return(0,s.useEffect)(()=>{let e=localStorage.getItem("tradetaper-theme");e?o(e):o(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},[]),(0,s.useEffect)(()=>{"dark"===t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("tradetaper-theme",t)},[t]),(0,r.jsx)(d.Provider,{value:{theme:t,setTheme:e=>{o(e)},toggleTheme:()=>{o(e=>"light"===e?"dark":"light")}},children:a})},l=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},80722:(e,a,t)=>{t.d(a,{Y0:()=>o,uE:()=>d,wv:()=>l});var r=t(23464);let s="https://tradetaper-backend-481634875325.us-central1.run.app/api/v1";console.log("\uD83D\uDD27 API Configuration:",{env:"production",apiUrl:s,envVar:"https://tradetaper-backend-481634875325.us-central1.run.app/api/v1",timestamp:new Date().toISOString()});let d=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"}}),o=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"}});function l(e){o.interceptors.request.use(a=>{let t=e().auth.token;return t&&(a.headers.Authorization="Bearer ".concat(t)),console.log("\uD83D\uDE80 Making authenticated API request to:",a.baseURL+a.url),a},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{var a,t,r;return console.error("‚ùå API Request failed:",{url:null==(a=e.config)?void 0:a.url,baseURL:null==(t=e.config)?void 0:t.baseURL,status:null==(r=e.response)?void 0:r.status,message:e.message}),e.response&&401===e.response.status&&console.log("Unauthorized from interceptor..."),Promise.reject(e)}),console.log("[API.TS] Auth interceptors configured.")}}}]);