(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6084],{32348:(e,t,a)=>{"use strict";a.d(t,{d:()=>n});var r=a(12115);function n(e,t){let[a,n]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),a}},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},47134:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var r=a(95155),n=a(12115),o=a(35695),s=a(29911),l=a(52436),i=a(31246),c=a(63014),d=a(13568),u=a(32348);function p(e,t){return{id:"block-".concat(Date.now(),"-").concat(Math.random()),type:e,content:function(e){switch(e){case"text":case"heading":default:return{text:""};case"quote":return{text:"",author:""};case"list":return{items:[""],ordered:!1};case"code":return{code:"",language:"javascript"};case"image":return{url:"",caption:"",alt:""};case"video":return{url:"",caption:""};case"embed":return{url:"",title:"",description:""};case"callout":return{text:"",type:"info",icon:"info"};case"table":return{headers:["Column 1","Column 2"],rows:[["",""],["",""]]};case"divider":return{}}}(e),position:t}}function g(e){switch(e.type){case"text":case"heading":case"quote":case"callout":return e.content.text||"";case"code":return e.content.code||"";default:return""}}let x=e=>{var t,a,o,l,i,u,p,x,b,y,h,v,f,j,N,w,k,C,S,A,D,O;let{block:P,onUpdate:E,onKeyDown:B,onAddBlock:I,onDelete:T}=e,[Y,U]=(0,n.useState)(!1),L=(e,t)=>{E({[e]:t})};switch(P.type){case"text":return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsx)("textarea",{id:"block-".concat(P.id),value:P.content.text||"",onChange:e=>L("text",e.target.value),onKeyDown:B,placeholder:"Type '/' for commands...",className:"w-full bg-transparent border-none outline-none resize-none min-h-[1.5rem] text-gray-800 dark:text-gray-200 placeholder-gray-400",rows:1,style:{height:"auto"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"}}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"heading":return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsx)("input",{id:"block-".concat(P.id),type:"text",value:P.content.text||"",onChange:e=>L("text",e.target.value),onKeyDown:B,placeholder:"Heading",className:"w-full bg-transparent border-none outline-none text-2xl font-bold text-gray-800 dark:text-gray-200 placeholder-gray-400"}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"quote":return(0,r.jsxs)("div",{className:"group relative border-l-4 border-gray-300 dark:border-gray-600 pl-4",children:[(0,r.jsx)("textarea",{id:"block-".concat(P.id),value:P.content.text||"",onChange:e=>L("text",e.target.value),onKeyDown:B,placeholder:"Quote...",className:"w-full bg-transparent border-none outline-none resize-none italic text-gray-600 dark:text-gray-400 placeholder-gray-400",rows:1}),(0,r.jsx)("input",{type:"text",value:P.content.author||"",onChange:e=>L("author",e.target.value),placeholder:"Author (optional)",className:"w-full bg-transparent border-none outline-none text-sm text-gray-500 dark:text-gray-500 placeholder-gray-400 mt-1"}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"list":return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,r.jsx)("button",{onClick:()=>{var e;return L("ordered",!(null==(e=P.content)?void 0:e.ordered))},className:"text-sm px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded",children:(null==(t=P.content)?void 0:t.ordered)?"Numbered":"Bulleted"})}),(0,r.jsx)("div",{className:"space-y-1",children:((null==(a=P.content)?void 0:a.items)||[""]).map((e,t)=>{var a;return(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-gray-400 pt-1",children:(null==(a=P.content)?void 0:a.ordered)?"".concat(t+1,"."):"•"}),(0,r.jsx)("input",{type:"text",value:e,onChange:e=>{var a;let r=[...(null==(a=P.content)?void 0:a.items)||[""]];r[t]=e.target.value,L("items",r)},onKeyDown:a=>{var r,n,o,s;if("Enter"===a.key){a.preventDefault();let e=[...(null==(o=P.content)?void 0:o.items)||[""]];e.splice(t+1,0,""),L("items",e)}else if("Backspace"===a.key&&!e&&((null==(n=P.content)||null==(r=n.items)?void 0:r.length)||0)>1){a.preventDefault();let e=[...(null==(s=P.content)?void 0:s.items)||[""]];e.splice(t,1),L("items",e)}},placeholder:"List item...",className:"flex-1 bg-transparent border-none outline-none text-gray-800 dark:text-gray-200 placeholder-gray-400"})]},t)})}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"code":return(0,r.jsxs)("div",{className:"group relative bg-gray-100 dark:bg-gray-800 rounded-lg p-4",children:[(0,r.jsxs)("select",{value:P.content.language||"javascript",onChange:e=>L("language",e.target.value),className:"mb-2 text-xs bg-transparent border-none outline-none text-gray-500",children:[(0,r.jsx)("option",{value:"javascript",children:"JavaScript"}),(0,r.jsx)("option",{value:"typescript",children:"TypeScript"}),(0,r.jsx)("option",{value:"python",children:"Python"}),(0,r.jsx)("option",{value:"html",children:"HTML"}),(0,r.jsx)("option",{value:"css",children:"CSS"}),(0,r.jsx)("option",{value:"json",children:"JSON"}),(0,r.jsx)("option",{value:"sql",children:"SQL"}),(0,r.jsx)("option",{value:"bash",children:"Bash"})]}),(0,r.jsx)("textarea",{id:"block-".concat(P.id),value:P.content.code||"",onChange:e=>L("code",e.target.value),onKeyDown:B,placeholder:"Enter code...",className:"w-full bg-transparent border-none outline-none resize-none font-mono text-sm text-gray-800 dark:text-gray-200 placeholder-gray-400",rows:3}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"image":return(0,r.jsxs)("div",{className:"group relative border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(s.dkL,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var t,a,r,n;let o=null==(t=e.target.files)?void 0:t[0];if(o){if(o.size>0xa00000)return void d.Ay.error("File size must be less than 10MB");L("uploading",!0),d.Ay.loading("Uploading image...",{id:"upload-"+P.id});try{let e=savedNoteId;if(!e&&(note.title||note.content.some(e=>g(e)))){let t=await c.j.createNote({title:note.title||"Untitled note",content:note.content,tags:note.tags,visibility:note.visibility,accountId:note.accountId,tradeId:note.tradeId});e=t.id,setSavedNoteId(t.id)}if(!e)throw Error("Unable to save note for media upload");let t=await c.j.uploadMedia(o,e);L("url",t.url),L("filename",t.filename),L("uploading",!1),d.Ay.success("Image uploaded successfully",{id:"upload-"+P.id})}catch(e){console.error("Failed to upload image:",e),L("uploading",!1),(null==e||null==(a=e.response)?void 0:a.status)===400?d.Ay.error("Please save your note first, then try uploading the image",{id:"upload-"+P.id}):d.Ay.error((null==e||null==(n=e.response)||null==(r=n.data)?void 0:r.message)||"Failed to upload image. You can paste image URL instead.",{id:"upload-"+P.id})}}},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"file-upload-".concat(P.id),disabled:null==(o=P.content)?void 0:o.uploading}),(0,r.jsx)("label",{htmlFor:"file-upload-".concat(P.id),className:"w-full py-2 px-4 rounded-lg cursor-pointer transition-colors inline-block text-center ".concat((null==(l=P.content)?void 0:l.uploading)?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"),children:(null==(i=P.content)?void 0:i.uploading)?(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)(s.hW,{className:"animate-spin"}),"Uploading..."]}):"Upload Image"})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"or"}),(0,r.jsx)("input",{type:"text",value:(null==(u=P.content)?void 0:u.url)||"",onChange:e=>L("url",e.target.value),placeholder:"Paste image URL...",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500",disabled:null==(p=P.content)?void 0:p.uploading}),(0,r.jsx)("input",{type:"text",value:(null==(x=P.content)?void 0:x.caption)||"",onChange:e=>L("caption",e.target.value),placeholder:"Caption (optional)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("input",{type:"text",value:(null==(b=P.content)?void 0:b.alt)||"",onChange:e=>L("alt",e.target.value),placeholder:"Alt text (optional)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"})]}),(null==(y=P.content)?void 0:y.url)&&!(null==(h=P.content)?void 0:h.uploading)&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("img",{src:P.content.url,alt:P.content.alt||"Image",className:"max-w-full h-auto rounded-lg",onError:e=>{e.target.style.display="none",d.Ay.error("Failed to load image")}}),P.content.caption&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic",children:P.content.caption})]})]}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"video":return(0,r.jsxs)("div",{className:"group relative border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(s.HiP,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsx)("input",{type:"text",value:(null==(v=P.content)?void 0:v.url)||"",onChange:e=>L("url",e.target.value),placeholder:"Video URL (YouTube, Vimeo, etc.)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("input",{type:"text",value:(null==(f=P.content)?void 0:f.caption)||"",onChange:e=>L("caption",e.target.value),placeholder:"Caption (optional)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"})]}),(null==(j=P.content)?void 0:j.url)&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("div",{className:"aspect-video bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden",children:(0,r.jsx)("iframe",{src:(e=>{var t,a,r;if(e.includes("youtube.com/watch?v=")){let a=null==(t=e.split("v=")[1])?void 0:t.split("&")[0];return"https://www.youtube.com/embed/".concat(a)}if(e.includes("youtu.be/")){let t=null==(a=e.split("youtu.be/")[1])?void 0:a.split("?")[0];return"https://www.youtube.com/embed/".concat(t)}if(e.includes("vimeo.com/")){let t=null==(r=e.split("vimeo.com/")[1])?void 0:r.split("?")[0];return"https://player.vimeo.com/video/".concat(t)}return e})(P.content.url),className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Video embed"})}),P.content.caption&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic",children:P.content.caption})]})]}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"embed":return(0,r.jsxs)("div",{className:"group relative border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(s.AnD,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsx)("input",{type:"text",value:(null==(N=P.content)?void 0:N.url)||"",onChange:e=>L("url",e.target.value),placeholder:"URL to embed",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("input",{type:"text",value:(null==(w=P.content)?void 0:w.title)||"",onChange:e=>L("title",e.target.value),placeholder:"Title (optional)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("textarea",{value:(null==(k=P.content)?void 0:k.description)||"",onChange:e=>L("description",e.target.value),placeholder:"Description (optional)",className:"w-full bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:2})]}),(null==(C=P.content)?void 0:C.url)&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:(0,r.jsxs)("div",{className:"text-left",children:[P.content.title&&(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:P.content.title}),(0,r.jsx)("p",{className:"text-sm text-blue-500 break-all",children:P.content.url}),P.content.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:P.content.description})]})})]}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"table":return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300 dark:border-gray-600",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[((null==(S=P.content)?void 0:S.headers)||[]).map((e,t)=>(0,r.jsx)("th",{className:"border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 p-2",children:(0,r.jsx)("input",{type:"text",value:e,onChange:e=>{var a;let r=[...(null==(a=P.content)?void 0:a.headers)||[]];r[t]=e.target.value,L("headers",r)},className:"w-full bg-transparent border-none outline-none text-sm font-medium",placeholder:"Header ".concat(t+1)})},t)),(0,r.jsx)("th",{className:"border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 p-2 w-10",children:(0,r.jsx)("button",{onClick:()=>{var e,t;let a=[...(null==(e=P.content)?void 0:e.headers)||[],""],r=((null==(t=P.content)?void 0:t.rows)||[]).map(e=>[...e,""]);L("headers",a),L("rows",r)},className:"text-blue-500 hover:text-blue-700",children:(0,r.jsx)(s.OiG,{size:12})})})]})}),(0,r.jsxs)("tbody",{children:[((null==(A=P.content)?void 0:A.rows)||[]).map((e,t)=>(0,r.jsxs)("tr",{children:[e.map((e,a)=>(0,r.jsx)("td",{className:"border border-gray-300 dark:border-gray-600 p-2",children:(0,r.jsx)("input",{type:"text",value:e,onChange:e=>{var r;let n=[...(null==(r=P.content)?void 0:r.rows)||[]];n[t][a]=e.target.value,L("rows",n)},className:"w-full bg-transparent border-none outline-none text-sm",placeholder:"Cell ".concat(t+1,"-").concat(a+1)})},a)),(0,r.jsx)("td",{className:"border border-gray-300 dark:border-gray-600 p-2 w-10",children:(0,r.jsx)("button",{onClick:()=>{var e;L("rows",((null==(e=P.content)?void 0:e.rows)||[]).filter((e,a)=>a!==t))},className:"text-red-500 hover:text-red-700",children:"\xd7"})})]},t)),(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:((null==(O=P.content)||null==(D=O.headers)?void 0:D.length)||0)+1,className:"border border-gray-300 dark:border-gray-600 p-2 text-center",children:(0,r.jsxs)("button",{onClick:()=>{var e,t,a;let r=Array((null==(t=P.content)||null==(e=t.headers)?void 0:e.length)||2).fill("");L("rows",[...(null==(a=P.content)?void 0:a.rows)||[],r])},className:"text-blue-500 hover:text-blue-700 text-sm",children:[(0,r.jsx)(s.OiG,{className:"inline mr-1",size:12}),"Add Row"]})})})]})]})}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"divider":return(0,r.jsxs)("div",{className:"group relative py-4",children:[(0,r.jsx)("hr",{className:"border-gray-300 dark:border-gray-600"}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});case"callout":let R={info:(0,r.jsx)(s.__w,{className:"text-blue-500"}),warning:(0,r.jsx)(s.BS8,{className:"text-yellow-500"}),success:(0,r.jsx)(s.A7C,{className:"text-green-500"})};return(0,r.jsxs)("div",{className:"group relative bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[R[P.content.type],(0,r.jsxs)("select",{value:P.content.type||"info",onChange:e=>L("type",e.target.value),className:"text-sm bg-transparent border-none outline-none",children:[(0,r.jsx)("option",{value:"info",children:"Info"}),(0,r.jsx)("option",{value:"warning",children:"Warning"}),(0,r.jsx)("option",{value:"success",children:"Success"})]})]}),(0,r.jsx)("textarea",{id:"block-".concat(P.id),value:P.content.text||"",onChange:e=>L("text",e.target.value),onKeyDown:B,placeholder:"Callout text...",className:"w-full bg-transparent border-none outline-none resize-none text-gray-800 dark:text-gray-200 placeholder-gray-400",rows:1}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]});default:return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-500",children:["Unsupported block type: ",P.type]}),(0,r.jsx)(m,{onAddBlock:I,onDelete:T})]})}},m=e=>{let{onAddBlock:t,onDelete:a}=e;return(0,r.jsxs)("div",{className:"absolute right-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>t("text"),className:"p-1 text-gray-400 hover:text-blue-500 transition-colors",title:"Add block",children:(0,r.jsx)(s.OiG,{size:12})}),(0,r.jsx)("button",{onClick:a,className:"p-1 text-gray-400 hover:text-red-500 transition-colors",title:"Delete block",children:"\xd7"})]})},b=e=>{let{x:t,y:a,onSelect:o,onClose:l}=e;(0,n.useEffect)(()=>{let e=e=>{e.target.closest(".block-menu")||l()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]);let i=[{type:"text",icon:(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDCDD"}),label:"Text",description:"Simple text block"},{type:"heading",icon:(0,r.jsx)(s.UEl,{className:"text-gray-600"}),label:"Heading",description:"Section heading"},{type:"quote",icon:(0,r.jsx)(s.JwJ,{className:"text-gray-600"}),label:"Quote",description:"Quote with attribution"},{type:"list",icon:(0,r.jsx)(s.v5n,{className:"text-gray-600"}),label:"List",description:"Bulleted or numbered list"},{type:"code",icon:(0,r.jsx)(s.FSj,{className:"text-gray-600"}),label:"Code",description:"Code block with syntax highlighting"},{type:"image",icon:(0,r.jsx)(s.dkL,{className:"text-blue-500"}),label:"Image",description:"Upload or embed an image"},{type:"video",icon:(0,r.jsx)(s.HiP,{className:"text-purple-500"}),label:"Video",description:"Embed a video"},{type:"embed",icon:(0,r.jsx)(s.AnD,{className:"text-green-500"}),label:"Embed",description:"Embed external content"},{type:"table",icon:(0,r.jsx)(s.ist,{className:"text-orange-500"}),label:"Table",description:"Structured data table"},{type:"divider",icon:(0,r.jsx)(s.iu5,{className:"text-gray-400"}),label:"Divider",description:"Visual separator"},{type:"callout",icon:(0,r.jsx)(s.__w,{className:"text-blue-500"}),label:"Callout",description:"Important information box"}],c=(0,n.useRef)(null),[d,u]=(0,n.useState)({x:t,y:a});return(0,n.useEffect)(()=>{if(c.current){let e=c.current.getBoundingClientRect(),r=window.innerWidth,n=window.innerHeight,o=t,s=a;t+e.width>r-20&&(o=r-e.width-20),a+e.height>n-20&&(s=a-e.height-10),u({x:o,y:s})}},[t,a]),(0,r.jsx)("div",{ref:c,className:"block-menu fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg min-w-[250px] max-w-[280px]",style:{left:d.x,top:d.y},children:(0,r.jsx)("div",{className:"p-2 max-h-[400px] overflow-y-auto",children:i.map(e=>(0,r.jsxs)("button",{onClick:()=>o(e.type),className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center",children:e.icon}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:e.description})]})]},e.type))})})},y=()=>{let e=(0,o.useRouter)(),[t,a]=(0,n.useState)({title:"",content:[p("text",0)],tags:[],visibility:"private"}),[m,y]=(0,n.useState)(!1),[h,v]=(0,n.useState)(!1),[f,j]=(0,n.useState)(null),[N,w]=(0,n.useState)(""),[k,C]=(0,n.useState)(!1),[S,A]=(0,n.useState)(null);(0,n.useRef)();let D=(0,u.d)(t,2e3),O=(0,n.useCallback)(async function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t.title||t.content.some(e=>g(e)))try{let r;y(!0);let n={title:t.title,content:t.content,tags:t.tags,visibility:t.visibility,accountId:t.accountId,tradeId:t.tradeId};S?r=await c.j.updateNote(S,n):(r=await c.j.createNote(n),A(r.id)),a||(d.Ay.success("Note saved successfully!"),e.push("/notes/".concat(r.id)))}catch(e){console.error("Error saving note:",e),a||d.Ay.error("Failed to save note. Please try again.")}finally{y(!1)}},[t.title,t.content,t.tags,t.visibility,t.accountId,t.tradeId,e,S]);(0,n.useEffect)(()=>{(D.title||D.content.some(e=>g(e)))&&O(!0)},[D,O]);let P=(e,t)=>{a(a=>({...a,content:a.content.map(a=>a.id===e?{...a,content:{...a.content,...t}}:a)}))},E=(e,r)=>{let n=r?t.content.findIndex(e=>e.id===r):t.content.length-1,o=p(e,n+1);a(e=>({...e,content:[...e.content.slice(0,n+1),o,...e.content.slice(n+1).map(e=>({...e,position:e.position+1}))]})),j(null),setTimeout(()=>{let e=document.getElementById("block-".concat(o.id));e&&e.focus()},100)},B=e=>{1!==t.content.length&&a(t=>({...t,content:t.content.filter(t=>t.id!==e)}))},I=(e,a)=>{if("Enter"!==e.key||e.shiftKey){if("Backspace"===e.key){let r=t.content.find(e=>e.id===a);r&&!g(r)&&t.content.length>1&&(e.preventDefault(),B(a))}else if("/"===e.key&&e.target instanceof HTMLElement&&""===(e.target.textContent||"")){e.preventDefault();let t=e.target.getBoundingClientRect();j({blockId:a,x:t.left,y:t.bottom+window.scrollY})}}else e.preventDefault(),E("text",a)},T=()=>{N.trim()&&!t.tags.includes(N.trim())&&(a(e=>({...e,tags:[...e.tags,N.trim()]})),w(""))},Y=e=>{a(t=>({...t,tags:t.tags.filter(t=>t!==e)}))};return(0,r.jsx)("div",{className:"min-h-screen pb-20",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(i.Qf,{onClick:()=>e.back(),variant:"ghost",icon:(0,r.jsx)(s.QVr,{}),iconPosition:"left",children:"Back"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("button",{onClick:()=>a(e=>({...e,visibility:"private"===e.visibility?"shared":"private"})),className:"flex items-center gap-2 px-3 py-1 rounded-lg border border-gray-300 dark:border-gray-600",children:["private"===t.visibility?(0,r.jsx)(s.mx3,{}):(0,r.jsx)(s.Ny1,{}),(0,r.jsx)("span",{className:"text-sm capitalize",children:t.visibility})]})}),(0,r.jsx)(i.Qf,{onClick:()=>O(!1),variant:"gradient",className:"bg-gradient-to-r from-blue-500 to-purple-500",icon:m?(0,r.jsx)(s.hW,{className:"animate-spin"}):(0,r.jsx)(s.dIn,{}),iconPosition:"left",disabled:m,children:m?"Saving...":"Save Note"})]})]}),(0,r.jsxs)(l.Ue,{variant:"glass",className:"p-8",children:[(0,r.jsx)("input",{type:"text",placeholder:"Untitled note",value:t.title,onChange:e=>a(t=>({...t,title:e.target.value})),className:"w-full text-4xl font-bold bg-transparent border-none outline-none placeholder-gray-400 dark:placeholder-gray-600 mb-8"}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[t.tags.map(e=>(0,r.jsxs)("span",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-sm",children:[e,(0,r.jsx)("button",{onClick:()=>Y(e),className:"text-blue-500 hover:text-blue-700",children:"\xd7"})]},e)),k?(0,r.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),T()):"Escape"===e.key&&(C(!1),w(""))},onBlur:()=>{N.trim()&&T(),C(!1)},placeholder:"Add tag...",className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-full text-sm outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,r.jsxs)("button",{onClick:()=>C(!0),className:"flex items-center gap-1 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-full text-sm text-gray-600 dark:text-gray-400 hover:text-blue-500",children:[(0,r.jsx)(s.BuZ,{}),"Add tag"]})]})}),(0,r.jsx)("div",{className:"space-y-4 min-h-[200px]",children:t.content.map((e,t)=>(0,r.jsx)(x,{block:e,onUpdate:t=>P(e.id,t),onKeyDown:t=>I(t,e.id),onAddBlock:t=>E(t,e.id),onDelete:()=>B(e.id)},e.id))}),(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsxs)("button",{onClick:()=>E("text"),className:"flex items-center gap-2 px-6 py-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-blue-300",children:[(0,r.jsx)(s.OiG,{}),(0,r.jsx)("span",{className:"font-medium",children:"Add a block"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>E("image"),className:"flex items-center gap-1 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors",title:"Add Image",children:[(0,r.jsx)(s.dkL,{}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Image"})]}),(0,r.jsxs)("button",{onClick:()=>E("video"),className:"flex items-center gap-1 px-3 py-2 text-sm text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-md transition-colors",title:"Add Video",children:[(0,r.jsx)(s.HiP,{}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Video"})]}),(0,r.jsxs)("button",{onClick:()=>E("table"),className:"flex items-center gap-1 px-3 py-2 text-sm text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-md transition-colors",title:"Add Table",children:[(0,r.jsx)(s.ist,{}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Table"})]}),(0,r.jsxs)("button",{onClick:()=>E("list"),className:"flex items-center gap-1 px-3 py-2 text-sm text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-md transition-colors",title:"Add List",children:[(0,r.jsx)(s.v5n,{}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"List"})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 text-center text-xs text-gray-500",children:["Current blocks: ",t.content.length," | Block types: ",t.content.map(e=>e.type).join(", ")]})]})]}),f&&(0,r.jsx)(b,{x:f.x,y:f.y,onSelect:e=>E(e,f.blockId),onClose:()=>j(null)})]})})}},63014:(e,t,a)=>{"use strict";a.d(t,{T:()=>o,j:()=>n});var r=a(80722);class n{static async createNote(e){return(await r.Y0.post("/notes",e)).data}static async getNotes(){var e,t,a;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=new URLSearchParams;Object.entries(n).forEach(e=>{let[t,a]=e;null!=a&&(Array.isArray(a)?a.forEach(e=>o.append(t,e.toString())):o.append(t,a.toString()))});let s="/notes?".concat(o.toString());console.log("\uD83D\uDD0D NotesService.getNotes Debug:",{params:n,searchParams:o.toString(),fullUrl:s,timestamp:new Date().toISOString()});let l=await r.Y0.get(s);return console.log("\uD83D\uDCE5 NotesService.getNotes Response:",{status:l.status,dataType:typeof l.data,notesCount:(null==(t=l.data)||null==(e=t.notes)?void 0:e.length)||0,total:(null==(a=l.data)?void 0:a.total)||0,url:s}),l.data}static async getNote(e){return(await r.Y0.get("/notes/".concat(e))).data}static async updateNote(e,t){return(await r.Y0.patch("/notes/".concat(e),t)).data}static async deleteNote(e){await r.Y0.delete("/notes/".concat(e))}static async togglePin(e){return(await r.Y0.patch("/notes/".concat(e,"/toggle-pin"))).data}static async getStats(){return(await r.Y0.get("/notes/stats")).data}static async getTags(){return(await r.Y0.get("/notes/tags")).data}static async getCalendarNotes(e,t){return(await r.Y0.get("/notes/calendar/".concat(e,"/").concat(t))).data}static async uploadMedia(e,t){let a=new FormData;return a.append("file",e),t&&a.append("noteId",t),(await r.Y0.post("/notes/media/upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}static async speechToText(e){let t=new FormData;return t.append("audio",e,"recording.webm"),(await r.Y0.post("/notes/speech-to-text",t,{headers:{"Content-Type":"multipart/form-data"}})).data}static async searchNotes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getNotes({...t,search:e})}static async getRecentNotes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(await this.getNotes({sortBy:"updatedAt",sortOrder:"DESC",limit:e})).notes}static async getPinnedNotes(){return(await this.getNotes({pinnedOnly:!0,sortBy:"updatedAt",sortOrder:"DESC"})).notes}static async getNotesWithMedia(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this.getNotes({hasMedia:!0,sortBy:"updatedAt",sortOrder:"DESC",limit:e})}static async getNotesByTag(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.getNotes({tags:[e],sortBy:"updatedAt",sortOrder:"DESC",limit:t})}static async getNotesByAccount(e){return this.getNotes({accountId:e,sortBy:"updatedAt",sortOrder:"DESC"})}static async getNotesByTrade(e){return this.getNotes({tradeId:e,sortBy:"createdAt",sortOrder:"ASC"})}static async exportNotes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;return Object.entries(t).forEach(e=>{let[t,r]=e;null!=r&&(Array.isArray(r)?r.forEach(e=>a.append(t,e.toString())):a.append(t,r.toString()))}),a.append("format",e),(await r.Y0.get("/notes/export?".concat(a.toString()),{responseType:"blob"})).data}static async duplicateNote(e){return(await r.Y0.post("/notes/".concat(e,"/duplicate"))).data}static async getTemplates(){return(await r.Y0.get("/notes/templates")).data}static async createFromTemplate(e,t){return(await r.Y0.post("/notes/templates/".concat(e,"/create"),{title:t})).data}static async getNotesForDate(e){return(await r.Y0.get("/notes/calendar/date/".concat(e))).data}static async getCalendarStats(e,t){return(await r.Y0.get("/notes/calendar/".concat(e,"/").concat(t,"/stats"))).data}static async getMediaUrl(e){return(await r.Y0.get("/notes/media/".concat(e,"/url"))).data.url}static async deleteMedia(e){await r.Y0.delete("/notes/media/".concat(e))}static async generateEmbedData(e){return(await r.Y0.post("/notes/media/embed",{url:e})).data}static async enhanceText(e,t){return(await r.Y0.post("/notes/ai/enhance-text",{text:e,task:t})).data}static async generateNoteSuggestions(e){return(await r.Y0.post("/notes/ai/generate-suggestions",{content:e})).data}static async exportNote(e,t){return(await r.Y0.get("/notes/".concat(e,"/export/").concat(t),{responseType:"blob"})).data}static async bulkDelete(e){await r.Y0.post("/notes/bulk/delete",{noteIds:e})}static async bulkUpdateTags(e,t){await r.Y0.post("/notes/bulk/tags",{noteIds:e,tags:t})}static async bulkUpdateVisibility(e,t){await r.Y0.post("/notes/bulk/visibility",{noteIds:e,visibility:t})}}let o=n},69114:(e,t,a)=>{Promise.resolve().then(a.bind(a,47134))},74436:(e,t,a)=>{"use strict";a.d(t,{k5:()=>d});var r=a(12115),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=r.createContext&&r.createContext(n),s=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){var r,n,o;r=e,n=t,o=a[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function d(e){return t=>r.createElement(u,l({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,a)=>r.createElement(t.tag,c({key:a},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var a,{attr:n,size:o,title:i}=e,d=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;a[r]=e[r]}return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,s),u=o||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),r.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,d,{className:a,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&r.createElement("title",null,i),e.children)};return void 0!==o?r.createElement(o.Consumer,null,e=>t(e)):t(n)}},80722:(e,t,a)=>{"use strict";a.d(t,{Y0:()=>s,uE:()=>o,wv:()=>l});var r=a(23464);let n="https://tradetaper-backend-481634875325.us-central1.run.app/api/v1";console.log("\uD83D\uDD27 API Configuration:",{env:"production",apiUrl:n,envVar:"https://tradetaper-backend-481634875325.us-central1.run.app/api/v1",timestamp:new Date().toISOString()});let o=r.A.create({baseURL:n,headers:{"Content-Type":"application/json"}}),s=r.A.create({baseURL:n,headers:{"Content-Type":"application/json"}});function l(e){s.interceptors.request.use(t=>{let a=e().auth.token;return a&&(t.headers.Authorization="Bearer ".concat(a)),console.log("\uD83D\uDE80 Making authenticated API request to:",t.baseURL+t.url),t},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t,a,r;return console.error("❌ API Request failed:",{url:null==(t=e.config)?void 0:t.url,baseURL:null==(a=e.config)?void 0:a.baseURL,status:null==(r=e.response)?void 0:r.status,message:e.message}),e.response&&401===e.response.status&&console.log("Unauthorized from interceptor..."),Promise.reject(e)}),console.log("[API.TS] Auth interceptors configured.")}}},e=>{var t=t=>e(e.s=t);e.O(0,[6711,3464,3568,6153,2055,8441,1684,7358],()=>t(69114)),_N_E=e.O()}]);